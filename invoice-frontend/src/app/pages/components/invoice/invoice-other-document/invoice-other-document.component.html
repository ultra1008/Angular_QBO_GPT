<!-- Invoice_preview -->
<mat-accordion [displayMode]="displayMode" [multi]="multi" class="mat-expansion-demo-width">
    <mat-nav-list>
        <!-- [expanded]="hide" -->
        <mat-expansion-panel [expanded]="hide" [hideToggle]="hideToggle">
            <mat-expansion-panel-header class="hover">
                <h4 class="mt-3">{{ "Invoice_preview" |
                    translate }}</h4>
            </mat-expansion-panel-header>
            <div class="pdf-data">

                <div class=" mt-1 pdf-header" *ngIf="has_document">
                    <button mat-raised-button color="primary" (click)="goToEdit()" class="cust-button-form"><img
                            src="{{editIcon}}" alt="" class="" height="20px" style=" padding-right: 4px;">{{'All-Edit' |
                        translate}}</button>
                    <button mat-raised-button color="primary" (click)="download()" class="cust-button-form"><img
                            src="{{downloadIcon}}" alt="" class="" height="20px"
                            style=" padding-right: 4px;">{{'PO-View-Download' |
                        translate}}</button>
                    <button mat-raised-button color="primary" (click)="print()" class="cust-button-form"><img
                            src="{{printIcon}}" alt="" class="" height="15px"
                            style=" padding-right: 4px;">{{'PO-View-Print'
                        |
                        translate}}</button>
                </div>
                <div class="pdf-viewer" *ngIf="has_document">
                    <pdf-viewer id="pdf" [src]="otherDocument.pdf_url" [rotation]="0" [original-size]="false"
                        [show-all]="true" [fit-to-page]="false" [zoom]="1" [zoom-scale]="'page-width'"
                        [stick-to-page]="false" [render-text]="true" [external-link-target]="'blank'"
                        [autoresize]="true" [show-borders]="false" [external-link-target]="'blank'"
                        style="display: block;"></pdf-viewer>
                </div>
                <div class="empty-document text-center" *ngIf="!has_document">
                    <button mat-raised-button color="primary" style="margin-right: 10px;width: 180px; "
                        (click)=" openAddDialog()" class="sign-button ml-1 mb-2">
                        {{'Add_files' | translate }}
                    </button>
                    <p>OR</p>
                    <button mat-raised-button color="primary" style="margin-right: 10px; width: 180px;"
                        (click)="openOrphanFilesDialog()" class="sign-button ml-1 mb-2">
                        {{'Orphan_Vendor_files' | translate }}
                    </button>
                    <p>OR</p>
                    <button mat-raised-button color="primary" style="margin-right: 10px;width: 180px; "
                        class="sign-button ml-1">
                        {{'Request_For_Files' | translate }}
                    </button>
                </div>
            </div>

        </mat-expansion-panel>
    </mat-nav-list>
    <!-- Notes -->
    <mat-nav-list>
        <!-- [expanded]="Notes" -->
        <mat-expansion-panel [hideToggle]="hideToggle" [disabled]="disabled">
            <mat-expansion-panel-header class="hover">
                <h4 class="mt-3">{{ "Project-Timecard-Notes" |
                    translate }}</h4>
            </mat-expansion-panel-header>
            <div class="task-data">
                <div class="d-flex justify-content-end">
                    <button mat-raised-button color="primary" (click)="addNotes()" class="sign-button m-3"><img
                            src="{{add_my_self_icon}}" alt="" height="20px">
                        {{'Project-Timecard-Notes' | translate }}
                    </button>
                </div>


                <div class="d-flex no-gutters" *ngFor="let nots of notesList">
                    <div class="col">
                        <div class=" note-card" style="justify-content: center;padding: 15px;"
                            [ngClass]="mode == 'on'? 'text-cust-notes-dark' : 'text-cust-notes'">
                            {{nots.notes}}<b class="update-date">{{temp_MMDDYYY_format(nots.updated_at)}}</b>
                        </div>
                    </div>
                    <div class="cust-margin mx-1 pt-2">
                        <a mat-icon-button aria-label="Example icon button with a vertical three dot icon"
                            (click)="deleteNote(nots._id,invoice_id)">
                            <mat-icon>delete</mat-icon>
                        </a>
                    </div>
                    <!-- <div class="col-10 col-sm-6 col-md-10">
                                                    <div class=" note-card" style="justify-content: center;padding: 15px;">
                                                        {{nots.notes}}<b
                                                            style="font-size: 10px;float: inline-end;;">{{temp_MMDDYYY_format(nots.updated_at)}}</b>
                                                    </div>
                                                </div>
                                                <div class="col-2 col-md-2">
                                                    <div class="cust-margin pt-2">
                                                        <a mat-icon-button
                                                            aria-label="Example icon button with a vertical three dot icon"
                                                            (click)="deleteNote(nots._id,invoice_id)">
                                                            <mat-icon>delete</mat-icon>
                                                        </a>
                                                    </div>
                                                </div> -->


                </div>

                <div *ngIf="show_Nots">
                    <div class="mt-3">
                        <form class="form text-center" [formGroup]="otherDocumentNoteform">
                            <mat-form-field appearance="outline" class="main-one-input-field">
                                <mat-label>{{'Project-Timecard-Notes' | translate }}</mat-label>
                                <textarea matInput appTextareaAutoresizeproject class="input-capitalized-textArea"
                                    formControlName="notes"
                                    placeholder="{{'Project-Timecard-Notes' | translate }}"></textarea>
                            </mat-form-field>
                        </form>
                    </div>
                    <div class="text-center mb-2">
                        <button mat-raised-button (click)="saveNotes()" color="primary" class="cust-button-form"><img
                                src="{{saveIcon}}" alt="" class="pr-1" height="15px">{{'All-save' |
                            translate}}</button>
                    </div>
                </div>
            </div>

        </mat-expansion-panel>
    </mat-nav-list>
    <!-- Attchments -->
    <mat-nav-list>
        <!-- [expanded]="Attchments" -->
        <mat-expansion-panel [hideToggle]="hideToggle" [disabled]="disabled">
            <mat-expansion-panel-header class="hover">
                <h4 class="mt-3">{{ "All-Attachment" | translate }}</h4>
            </mat-expansion-panel-header>
            <div class="row d-flex justify-content-end mt-1">

                <div class="container-cust" [ngClass]="mode == 'on'? 'button_dark' : 'button_light'" appDnd
                    (fileDropped)="onFileDropped($event)">
                    <input type="file" #fileDropRef id="fileDropRef" multiple
                        (change)="fileBrowseHandler($event.target.files)" />
                    <label for="fileDropRef"><img src="{{add_my_self_icon}}" alt="" height="20px">
                        {{'All-Attachment' | translate}}</label>
                </div>
            </div>
            <!-- <div class="task-data" *ngFor="let attchments of attchmentList">
                                <img src="{{attchments}}" width="15%" style="padding-top: 15px;" />
                            </div> -->
            <div class="row cust-margin">
                <div class="files-list">
                    <div class="single-file" *ngFor="let file of files; let i = index">
                        <div class="file-icon">
                            <img [src]="thumbImage(file)" alt="">
                        </div>
                        <div class="info" alignment="center">
                            <h4 class="name">
                                {{ file?.name }}
                            </h4>
                        </div>

                        <div class="delete" (click)="deleteFile(i)">
                            <svg xmlns="http://www.w3.org/2000/svg" width="14" height="18" viewBox="0 0 14 18">
                                <path fill="#B1B1B1" fill-rule="nonzero"
                                    d="M1 16c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2H3c-1.1 0-2 .9-2 2v10zm3.17-7.83a.996.996 0 0 1 1.41 0L7 9.59l1.42-1.42a.996.996 0 1 1 1.41 1.41L8.41 11l1.42 1.42a.996.996 0 1 1-1.41 1.41L7 12.41l-1.42 1.42a.996.996 0 1 1-1.41-1.41L5.59 11 4.17 9.58a.996.996 0 0 1 0-1.41zM10.5 1L9.79.29C9.61.11 9.35 0 9.09 0H4.91c-.26 0-.52.11-.7.29L3.5 1H1c-.55 0-1 .45-1 1s.45 1 1 1h12c.55 0 1-.45 1-1s-.45-1-1-1h-2.5z" />
                            </svg>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row cust-margin">
                <div class="files-list">

                    <div class="single-file" *ngFor="let file of files_old; let i = index">
                        <div class="file-icon" (click)="imageNetworkPreview(files_old, i)">
                            <img [src]="thumbNetworkImage(i)" alt="">
                        </div>
                        <div class="info" alignment="center">
                            <h4 class="name">
                                {{ file.split('/').pop() }}
                            </h4>
                        </div>

                        <div class="delete" (click)="deleteFile_old(i)">
                            <svg xmlns="http://www.w3.org/2000/svg" width="14" height="18" viewBox="0 0 14 18">
                                <path fill="#B1B1B1" fill-rule="nonzero"
                                    d="M1 16c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2H3c-1.1 0-2 .9-2 2v10zm3.17-7.83a.996.996 0 0 1 1.41 0L7 9.59l1.42-1.42a.996.996 0 1 1 1.41 1.41L8.41 11l1.42 1.42a.996.996 0 1 1-1.41 1.41L7 12.41l-1.42 1.42a.996.996 0 1 1-1.41-1.41L5.59 11 4.17 9.58a.996.996 0 0 1 0-1.41zM10.5 1L9.79.29C9.61.11 9.35 0 9.09 0H4.91c-.26 0-.52.11-.7.29L3.5 1H1c-.55 0-1 .45-1 1s.45 1 1 1h12c.55 0 1-.45 1-1s-.45-1-1-1h-2.5z" />
                            </svg>
                        </div>
                    </div>
                </div>
            </div>
            <div class="text-center mb-2" *ngIf="files.length">
                <button mat-raised-button (click)="saveAttchment()" color="primary" class="cust-button-form"><img
                        src="{{saveIcon}}" alt="" class="pr-1" height="15px">{{'All-save' |
                    translate}}</button>
            </div>

        </mat-expansion-panel>
    </mat-nav-list>
</mat-accordion>
<ngx-gallery [options]="galleryOptions" [images]="galleryImages" #gallery></ngx-gallery>
