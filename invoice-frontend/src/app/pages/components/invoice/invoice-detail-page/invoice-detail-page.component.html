<div class="wrapper-cust-admin" fxLayout style="height: 95%">
    <div class="invoice-data" [ngClass]="mode == 'on'? 'header-text-cust-chart-dark' : 'header-text-cust-chart'">
        <div class="d-flex justify-content-between p-3">
            <!-- <img src="{{placeholderIcon}}" alt="" height="20px"> -->
            <div>
                <p class="title">Invoice #</p>
                <p *ngIf="loadInvoice">{{invoiceData.invoice}}</p>
                <p *ngIf="!loadInvoice"></p>
            </div>
            <div>
                <p class="title">P.O #</p>
                <p *ngIf="loadInvoice">{{invoiceData.p_o}}</p>
                <p *ngIf="!loadInvoice"></p>
            </div>
            <div>
                <p class="title">Packing Slip</p>
                <p *ngIf="loadInvoice">{{invoiceData.packing_slip}}</p>
                <p *ngIf="!loadInvoice"></p>
            </div>
            <div>
                <p class="title">Receiving Slip</p>
                <p *ngIf="loadInvoice">{{invoiceData.receiving_slip}}</p>
                <p *ngIf="!loadInvoice"></p>
            </div>
            <div>
                <p class="title">{{'Files_Attached' | translate}}</p>
                <p *ngIf="loadInvoice">{{invoiceData.attach_files}}</p>
                <p *ngIf="!loadInvoice"></p>
            </div>
            <!-- <div>
                <p class="title">Notes</p>
                <p *ngIf="loadInvoice">{{invoiceData.notes}}</p>
                <p *ngIf="!loadInvoice"></p>
            </div> -->
            <div>
                <p class="title">Status</p>
                <p [ngClass]="invoiceData.status == 'Pending'? 'pendingcss' : 'Approvedcss' && invoiceData.status == 'Approved'? 'Approvedcss' : 'Rejectcss'&& invoiceData.status == 'Rejected'? 'Rejectcss' : 'Rejectcss'"
                    *ngIf="loadInvoice">
                    {{invoiceData.status}}
                </p>
                <p *ngIf="!loadInvoice"></p>
            </div>
            <div class="row my-2">
                <!-- <button mat-raised-button color="primary" style="margin-right: 6px;" class="sign-button ml-1">
                    Save Changes
                </button> -->

                <button *ngIf="role_permission.invoice.Edit" mat-raised-button color="primary"
                    style="margin-right: 12px;" class="sign-button">
                    <img src="{{add_my_self_icon}}" alt="" height="20px">
                    Add to batch
                </button>
                <button (click)="openHistoryDialog()"
                    class="import-export-btn-datatable button_workersEditClass cust-margin-div mr-2 "
                    matTooltip="{{ 'TOOLTIP_HISTORY' | translate }}">
                    <img src="{{historyIcon}}" alt="" height="20px">
                </button>
                <button class="import-export-btn-datatable cust-margin-div" (click)="back()"
                    matTooltip="{{ 'All-exit' | translate }}">
                    <img src="{{exitIcon}}" alt="" class="far fa-paper-plane" height="20px">
                </button>
            </div>
        </div>
    </div>
    <div class="row mt-2" style="height:90%">
        <div class="col-sm-12 col-md-12 col-lg-6">
            <!-- <div class="invoice-card">
                <h2 class=" text-center ">Invoice-123</h2>
            </div>
            <div class="invoice-viwe">

            </div>
            <div class="notes">
                <h3 style="text-justify: center;">Notes</h3>
            </div> -->
            <!-- Invoice_preview -->
            <mat-accordion [displayMode]="displayMode" [multi]="multi" class="mat-expansion-demo-width">
                <mat-nav-list>
                    <!-- [expanded]="hide" -->

                    <mat-expansion-panel [expanded]="hide" [hideToggle]="hideToggle">
                        <mat-expansion-panel-header class="hover">
                            <h4 class="mt-3">{{ "Invoice_preview" | translate }}</h4>
                        </mat-expansion-panel-header>
                        <div class="pdf-data">
                            <div class=" mt-1 pdf-header">
                                <button *ngIf="role_permission.invoice.Edit" mat-raised-button color="primary"
                                    (click)="goToInvoiceEdit(invoiceData)" class="cust-button-form"><img
                                        src="{{editIcon}}" alt="" class="" height="20px"
                                        style=" padding-right: 4px;">{{'All-Edit' |
                                    translate}}</button>
                                <button mat-raised-button color="primary" (click)="download()"
                                    class="cust-button-form"><img src="{{downloadIcon}}" alt="" class="" height="20px"
                                        style=" padding-right: 4px;">{{'PO-View-Download' |
                                    translate}}</button>
                                <button mat-raised-button color="primary" (click)="print()"
                                    class="cust-button-form"><img src="{{printIcon}}" alt="" class="" height="15px"
                                        style=" padding-right: 4px;">{{'PO-View-Print' |
                                    translate}}</button>
                            </div>
                            <div class="pdf-viewer" *ngIf="loadInvoice">
                                <pdf-viewer id="pdf" [src]="invoiceData.pdf_url" [rotation]="0" [original-size]="false"
                                    [show-all]="true" [fit-to-page]="false" [zoom]="1" [zoom-scale]="'page-width'"
                                    [stick-to-page]="false" [render-text]="true" [external-link-target]="'blank'"
                                    [autoresize]="true" [show-borders]="false" [external-link-target]="'blank'"
                                    style="display: block;"></pdf-viewer>
                            </div>
                        </div>

                    </mat-expansion-panel>
                </mat-nav-list>
                <!-- invoice-Notes -->
                <mat-nav-list>
                    <!-- [expanded]="invoice_notes" -->
                    <mat-expansion-panel [hideToggle]="hideToggle" [disabled]="disabled">
                        <mat-expansion-panel-header class="hover">
                            <h4 class="mt-3">{{ "Project-Timecard-Notes" |
                                translate }}</h4>
                        </mat-expansion-panel-header>
                        <div class="task-data">
                            <div class="d-flex justify-content-end">
                                <button *ngIf="role_permission.invoice.Edit" mat-raised-button color="primary"
                                    (click)="addNotes()" class="sign-button m-3"><img src="{{add_my_self_icon}}" alt=""
                                        height="20px">
                                    {{'Project-Timecard-Notes' | translate }}
                                </button>
                            </div>
                            <div class="d-flex no-gutters m-3" *ngFor="let nots of notsList">
                                <div class="col">
                                    <div class=" note-card" style="justify-content: center;padding: 20px;"
                                        [ngClass]="mode == 'on'? 'text-cust-notes-dark' : 'text-cust-notes'">
                                        {{nots.notes}}<b
                                            style="font-size: 10px;float: inline-end;;">{{temp_MMDDYYY_format(nots.updated_at)}}</b>
                                    </div>
                                </div>
                                <div class="cust-margin mx-1 pt-2">
                                    <a *ngIf="role_permission.invoice.Edit" mat-icon-button
                                        aria-label="Example icon button with a vertical three dot icon"
                                        (click)="deleteNote(nots._id,invoice_id)">
                                        <mat-icon>delete</mat-icon>
                                    </a>
                                </div>
                                <!-- <div class="col-10 col-sm-6 col-md-10">
                                    <div class=" note-card" style="justify-content: center;padding: 15px;">
                                        {{nots.notes}}<b
                                            style="font-size: 10px;float: inline-end;;">{{temp_MMDDYYY_format(nots.updated_at)}}</b>
                                    </div>
                                </div>
                                <div class="col-2 col-md-2">
                                    <div class="cust-margin pt-2">
                                        <a mat-icon-button
                                            aria-label="Example icon button with a vertical three dot icon"
                                            (click)="deleteNote(nots._id,invoice_id)">
                                            <mat-icon>delete</mat-icon>
                                        </a>
                                    </div>
                                </div> -->


                            </div>
                            <div *ngIf="show_Nots">
                                <div class="mt-3">
                                    <form class="form text-center p-2" [formGroup]="invoiceNoteform">
                                        <mat-form-field appearance="outline" class="main-one-input-field">
                                            <mat-label>{{'Project-Timecard-Notes' | translate }}</mat-label>
                                            <textarea matInput appTextareaAutoresizeproject
                                                class="input-capitalized-textArea" formControlName="notes"
                                                placeholder="{{'Project-Timecard-Notes' | translate }}"></textarea>
                                        </mat-form-field>
                                    </form>
                                </div>
                                <div class="text-center mb-2">
                                    <button *ngIf="role_permission.invoice.Edit" mat-raised-button (click)="saveNotes()"
                                        color="primary" class="cust-button-form"><img src="{{saveIcon}}" alt=""
                                            class="pr-1" height="15px">{{'All-save' |
                                        translate}}</button>
                                </div>
                            </div>
                        </div>

                    </mat-expansion-panel>

                </mat-nav-list>
                <!-- Attchments -->
                <mat-nav-list>
                    <!-- [expanded]="Attchments" -->
                    <mat-expansion-panel [hideToggle]="hideToggle" [disabled]="disabled">
                        <mat-expansion-panel-header class="hover">
                            <h4 class="mt-3">{{ "All-Attachment" | translate }}</h4>
                        </mat-expansion-panel-header>
                        <div class="row d-flex justify-content-end mt-1">

                            <div *ngIf="role_permission.invoice.Edit" class="container-cust"
                                [ngClass]="mode == 'on'? 'button_dark' : 'button_light'" appDnd
                                (fileDropped)="onFileDropped($event)">
                                <input type="file" #fileDropRef id="fileDropRef" multiple
                                    (change)="fileBrowseHandler($event.target.files)" />
                                <label for="fileDropRef"><img src="{{add_my_self_icon}}" alt="" height="20px">
                                    {{'All-Attachment' | translate}}</label>
                            </div>
                        </div>
                        <!-- <div class="task-data" *ngFor="let attchments of attchmentList">
                            <img src="{{attchments}}" width="15%" style="padding-top: 15px;" />
                        </div> -->
                        <div class="row cust-margin">
                            <div class="files-list">
                                <div class="single-file" *ngFor="let file of files; let i = index">
                                    <div class="file-icon">
                                        <img [src]="thumbImage(file)" alt="">
                                    </div>
                                    <div class="info" alignment="center">
                                        <h4 class="name">
                                            {{ file?.name }}
                                        </h4>
                                    </div>

                                    <div class="delete" (click)="deleteFile(i)">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="14" height="18"
                                            viewBox="0 0 14 18">
                                            <path fill="#B1B1B1" fill-rule="nonzero"
                                                d="M1 16c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2H3c-1.1 0-2 .9-2 2v10zm3.17-7.83a.996.996 0 0 1 1.41 0L7 9.59l1.42-1.42a.996.996 0 1 1 1.41 1.41L8.41 11l1.42 1.42a.996.996 0 1 1-1.41 1.41L7 12.41l-1.42 1.42a.996.996 0 1 1-1.41-1.41L5.59 11 4.17 9.58a.996.996 0 0 1 0-1.41zM10.5 1L9.79.29C9.61.11 9.35 0 9.09 0H4.91c-.26 0-.52.11-.7.29L3.5 1H1c-.55 0-1 .45-1 1s.45 1 1 1h12c.55 0 1-.45 1-1s-.45-1-1-1h-2.5z" />
                                        </svg>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row cust-margin">
                            <div class="files-list">

                                <div class="single-file" *ngFor="let file of files_old; let i = index">
                                    <div class="file-icon" (click)="imageNetworkPreview(files_old, i)">
                                        <img [src]="thumbNetworkImage(i)" alt="">
                                    </div>
                                    <div class="info" alignment="center">
                                        <h4 class="name">
                                            {{ file.split('/').pop() }}
                                        </h4>
                                    </div>

                                    <div class="delete" *ngIf="role_permission.invoice.Delete"
                                        (click)="deleteFile_old(i)">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="14" height="18"
                                            viewBox="0 0 14 18">
                                            <path fill="#B1B1B1" fill-rule="nonzero"
                                                d="M1 16c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2H3c-1.1 0-2 .9-2 2v10zm3.17-7.83a.996.996 0 0 1 1.41 0L7 9.59l1.42-1.42a.996.996 0 1 1 1.41 1.41L8.41 11l1.42 1.42a.996.996 0 1 1-1.41 1.41L7 12.41l-1.42 1.42a.996.996 0 1 1-1.41-1.41L5.59 11 4.17 9.58a.996.996 0 0 1 0-1.41zM10.5 1L9.79.29C9.61.11 9.35 0 9.09 0H4.91c-.26 0-.52.11-.7.29L3.5 1H1c-.55 0-1 .45-1 1s.45 1 1 1h12c.55 0 1-.45 1-1s-.45-1-1-1h-2.5z" />
                                        </svg>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="text-center mb-2" *ngIf="files.length">
                            <button *ngIf="role_permission.invoice.Edit" mat-raised-button (click)="saveAttchment()"
                                color="primary" class="cust-button-form"><img src="{{saveIcon}}" alt="" class="pr-1"
                                    height="15px">{{'All-save' |
                                translate}}</button>
                        </div>

                    </mat-expansion-panel>
                </mat-nav-list>
            </mat-accordion>
        </div>
        <!-- history div -->
        <!-- <div class="col-sm-12 col-md-12 col-lg-2 mt-3">
            <div class="invoice-card" [ngClass]="mode == 'on'? 'invoice-card-dark':''">
                <h4 class="History-text">History Log</h4>
            </div>
            <div class="history-viwe">
                <div class=" mt-2" [ngClass]="mode == 'on'? 'header-text-cust-chart-dark' : 'header-text-cust-chart'">
                    <p style="font-size: 10px;  word-wrap: break-word; text-align: left; color: #06479D;">
                        Today
                    </p>
                    <div class="search-results" [ngClass]="mode == 'on'? 'card-history-dark' : 'card-history'">
                        <div class="card-body " *ngFor=" let item of dashboardHistory">
                            <div class="row">
                                <div class="col-2">
                               
                                    <img class="crl card-img-left example-card-img-responsive"
                                        src="{{item.userpicture || '../assets/images/user_placeholder.png'}}" />
                                </div>
                              
                                <div class="col-10 ">
                                    <b [ngClass]="mode == 'on'? 'text-color-dark' : 'text-color'"
                                        (click)="goToUserProfile(item)" style="font-size: 10px;">
                                        {{item.user.userfullname}} </b>
                                    <b style="font-size: 10px;">{{item.action}}</b><b
                                        [ngClass]="mode == 'on'? 'text-color-dark' : 'text-color'"
                                        style="font-size: 10px;" (click)="goToInvoiceForm(item)">

                                        {{item.module}} </b>
                                    <b style="font-size: 10px;">at </b>
                                    <b style="font-size: 10px;">{{temp_MMDDYYY_format(item.created_at)}}</b>
                                    <b style="font-size: 10px;"> from </b>
                                    <b style="font-size: 10px;">{{item.action_from}}.</b>

                                </div>

                            </div>
                            <hr class="solid">
                        </div>
                    </div>
                
                </div>

            </div>
        </div> -->
        <!-- history div over -->
        <div class="col-sm-12 col-md-12 col-lg-6">
            <div class="wrapper-cust-admin">

                <div class="container">
                    <div *ngIf="show_tabs">
                        <mat-tab-group mat-align-tabs="center">
                            <mat-tab label="{{'P.O' | translate }}">
                                <app-invoice-other-document
                                    [documentType]="documentTypes.po"></app-invoice-other-document>

                            </mat-tab>
                            <mat-tab label="{{ 'Packing Slip' | translate }}">
                                <app-invoice-other-document
                                    [documentType]="documentTypes.packingSlip"></app-invoice-other-document>

                            </mat-tab>
                            <mat-tab label="{{'Receiving Slip' | translate}} ">
                                <app-invoice-other-document
                                    [documentType]="documentTypes.receivingSlip"></app-invoice-other-document>

                            </mat-tab>

                            <mat-tab label="{{'Quote' | translate }}">
                                <app-invoice-other-document
                                    [documentType]="documentTypes.quote"></app-invoice-other-document>

                            </mat-tab>

                        </mat-tab-group>

                    </div>
                </div>
            </div>
        </div>

    </div>
</div>



<ngx-gallery [options]="galleryOptions" [images]="galleryImages" #gallery></ngx-gallery>
